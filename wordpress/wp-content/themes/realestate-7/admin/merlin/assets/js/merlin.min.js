var Merlin=function(e){var n={install_child:function(n){(new function(){var n,i=e(".merlin__body"),t=e("#child-theme-text");function o(e){void 0!==e.done?(setTimeout(function(){t.addClass("lead")},0),setTimeout(function(){t.addClass("success"),t.html(e.message)},600),n()):(t.addClass("lead error"),t.html(e.error))}return{init:function(t){n=function(){setTimeout(function(){e(".merlin__body").addClass("js--finished")},1500),i.removeClass(drawer_opened),setTimeout(function(){e(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=t.href},4e3)},jQuery.post(merlin_params.ajaxurl,{action:"merlin_child_theme",wpnonce:merlin_params.wpnonce},o).fail(o)}}}).init(n)},activate_license:function(n){(new function(){var n,i=e(".merlin__body"),t=e("#theme-license-text");function o(i){void 0!==i.success&&i.success?(t.siblings(".error-message").remove(),setTimeout(function(){t.addClass("lead")},0),setTimeout(function(){t.addClass("success"),t.html(i.message)},600),n()):(e(".js-merlin-theme-license-activate-button").removeClass("merlin__button--loading").data("done-loading","no"),t.siblings(".error-message").remove(),t.after('<p class="error-message">'+i.message+"<p>"),t.siblings(".error-message").addClass("lead error"))}return{init:function(t){n=function(){setTimeout(function(){e(".merlin__body").addClass("js--finished")},1500),i.removeClass(drawer_opened),setTimeout(function(){e(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=t.href},4e3)},jQuery.post(merlin_params.ajaxurl,{action:"merlin_activate_license",wpnonce:merlin_params.wpnonce,license_key:e(".js-license-key").val()},o).fail(o)}}}).init(n)},install_plugins:function(n){(new function(){var n,i,t=e(".merlin__body"),o=0,s="",a="";function r(e){"object"==typeof e&&void 0!==e.message?(i.find("span").text(e.message),void 0!==e.url?e.hash==a?(i.find("span").text("failed"),d()):(a=e.hash,jQuery.post(e.url,e,function(e){l()}).fail(r)):(e.done,d())):(i.find("span").text("Success"),d())}function l(){s&&jQuery.post(merlin_params.ajaxurl,{action:"merlin_plugins",wpnonce:merlin_params.wpnonce,slug:s},r).fail(r)}function d(){var t=!1;i&&(i.data("done_item")||(o++,i.data("done_item",1)),i.find(".spinner").css("visibility","hidden"));var a=e(".merlin__drawer--install-plugins li");a.each(function(){""==s||t?(s=e(this).data("slug"),i=e(this),l(),t=!1):e(this).data("slug")==s&&(t=!0)}),o>=a.length&&n()}return{init:function(i){e(".merlin__drawer--install-plugins").addClass("installing"),n=function(){setTimeout(function(){e(".merlin__body").addClass("js--finished")},1e3),t.removeClass(drawer_opened),setTimeout(function(){e(".merlin__body").addClass("exiting")},3e3),setTimeout(function(){window.location.href=i.href},3500)},d()}}}).init(n)},install_content:function(n){(new function(){var n,i,t=e(".merlin__body"),o=0,s="",a="";function r(n){var t=i.find("label");"object"==typeof n&&void 0!==n.message?(t.addClass(n.message.toLowerCase()),void 0!==n.url?n.hash===a?(t.addClass("status--failed"),l()):(a=n.hash,void 0===n.selected_index&&(n.selected_index=e(".js-merlin-demo-import-select").val()||0),jQuery.post(n.url,n,r).fail(r)):(n.done,l())):(console.log(n),t.addClass("status--error"),l())}function l(){var t=!1;i&&(i.data("done_item")||(o++,i.data("done_item",1)),i.find(".spinner").css("visibility","hidden"));var a=e(".merlin__drawer--import-content__list-item");e(".merlin__drawer--import-content__list-item input:checked");a.each(function(){""==s||t?(s=e(this).data("content"),i=e(this),function(){if(s){var n=i.find("input:checkbox");n.is(":checked")?jQuery.post(merlin_params.ajaxurl,{action:"merlin_content",wpnonce:merlin_params.wpnonce,content:s,selected_index:e(".js-merlin-demo-import-select").val()||0},r).fail(r):(i.addClass("skipping"),setTimeout(l,300))}}(),t=!1):e(this).data("content")==s&&(t=!0)}),o>=a.length&&n()}return{init:function(i){e(".merlin__drawer--import-content").addClass("installing"),e(".merlin__drawer--import-content").find("input").prop("disabled",!0),n=function(){e.post(merlin_params.ajaxurl,{action:"merlin_import_finished",wpnonce:merlin_params.wpnonce,selected_index:e(".js-merlin-demo-import-select").val()||0}),setTimeout(function(){t.removeClass(drawer_opened)},500),setTimeout(function(){e(".merlin__body").addClass("js--finished")},1500),setTimeout(function(){e(".merlin__body").addClass("exiting")},3400),setTimeout(function(){window.location.href=i.href},4e3)},l()}}}).init(n)}};function i(){var i=e(".merlin__body"),t=(e(".merlin__body--loading"),e(".merlin__body--exiting"),e("#merlin__drawer-trigger"));drawer_opened="merlin__drawer--open",setTimeout(function(){i.addClass("loaded")},100),t.on("click",function(){i.toggleClass(drawer_opened)}),e(".merlin__button--proceed:not(.merlin__button--closer)").click(function(e){e.preventDefault();var n=this.getAttribute("href");i.addClass("exiting"),setTimeout(function(){window.location=n},400)}),e(".merlin__button--closer").on("click",function(e){i.removeClass(drawer_opened),e.preventDefault();var n=this.getAttribute("href");setTimeout(function(){i.addClass("exiting")},600),setTimeout(function(){window.location=n},1100)}),e(".button-next").on("click",function(i){if(i.preventDefault(),!function(e){var n=jQuery(e);if("yes"==n.data("done-loading"))return!1;n.is("input")||n.is("button");return n.data("done-loading","yes"),n.addClass("merlin__button--loading"),{done:function(){!0,n.attr("disabled",!1)}}}(this))return!1;var t=e(this).data("callback");return!t||void 0===n[t]||(n[t](this),!1)}),e(document).on("change",".js-merlin-demo-import-select",function(){var n=e(this).val(),i=e(this).children(":selected");i.data("img-src"),i.data("notice"),i.data("preview-url");e.post(merlin_params.ajaxurl,{action:"merlin_update_selected_import_data_info",wpnonce:merlin_params.wpnonce,selected_index:n},function(n){n.success?e(".js-merlin-drawer-import-content").html(n.data):alert(merlin_params.texts.something_went_wrong)}).fail(function(){alert(merlin_params.texts.something_went_wrong)})})}return{init:function(){this,e(i)},callback:function(e){console.log(e),console.log(this)}}}(jQuery);Merlin.init();